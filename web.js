var express = require("express");var app = express();//app.use(express.logger());app.use(express.bodyParser());var path = require('path');// NODE as a Webserverapp.use(express.static(path.join(__dirname, 'public')));var port = process.env.PORT || 5000;app.listen(port, function() {	console.log("Scrum Print Server on " + port);});app.post('/ws', function(request, response) {  	//console.log(JSON.stringify(request.body));	var scrumCards = request.body;	//console.log('Start PDF');	var PDFDocument, doc;	PDFDocument = require('pdfkit');	doc = new PDFDocument({		info: {		  Title: 'Scrum Cards',		  Author: 'fmoneo@expedia.com'		}	});	for(var i = 0; i < scrumCards.length; i++){		fillCard(doc,scrumCards[i].id,scrumCards[i].title, scrumCards[i].assignedTo, scrumCards[i].pri, scrumCards[i].hours, scrumCards[i].type, i); 	}		doc.write('public\\pdf\\out.pdf');	response.send("public\\pdf\\out.pdf");});function fillCard(doc, id, title, assignedTo, pri, hours, type, counter) {	var x=0, y=0, color="#005595"; //005595 is the Default Blue Color	var hoursOrSP = "hours";		if(counter%4 == 0 && counter>0){		doc.addPage({			size: 'letter',			layout: 'portrait'		});	}		switch(counter%4){		case 0:			x=0;			y=0;			break;		case 1:			x=288;			y=0;			break;		case 2:			x=0;			y=288;			break;		case 3:			x=288;			y=288;				break;	}		switch(type){		case "User Story":			color = "#7030A0";			hoursOrSP = "SP";			break;		case "Dev Task":			color = "#E36C0A";			break;		case "Test Task":			color = "#00B0F0";			break;		case "PM Task":			color = "#92D050";			break;		case "Release Task":			color = "#808080";			break;		case "Bug":			color = "#C00000";			break;	}	id = id.slice(0,12);	title = title.slice(0,110);		// Sep 9, 2013 - For assigned to field use first name and first initial of last name.	var spaceIndex = assignedTo.indexOf(" ")	if(spaceIndex != -1) {		assignedTo = assignedTo.slice(0,spaceIndex+2)+".";	}		assignedTo = assignedTo.slice(0,12);		pri = pri.slice(0,6);	hours = hours.slice(0,2);	doc.rect(18+x, 108+y, 288, 288).fillAndStroke("white", "black").stroke;	doc.rect(18+x, 108+y, 288, 36).fillAndStroke(color, "black").stroke;	doc.rect(18+x, 353+y, 80, 43).fillAndStroke("white", "black").stroke;	doc.rect(98+x, 353+y, 128, 43).fillAndStroke("white", "black").stroke;		doc.rect(226+x, 353+y, 80, 43).fillAndStroke("white", "black").stroke;			doc.fontSize(25);	doc.font('Helvetica-Bold');		doc.fillColor('white');	doc.text(id, 28+x, 116+y, {		width: 268	});		doc.font('Helvetica');	doc.fillColor('black');	doc.text(title, 36+x, 162+y, {		width: 250,		align: 'center'	});		doc.fontSize(16);		doc.text(hours + " " + hoursOrSP, 23+x, 367+y, {		width: 70,		align: 'center'	});		doc.text(assignedTo, 103+x, 367+y, {		width: 118,		align: 'center'	});				doc.text(pri, 231+x, 367+y, {		width: 70,		align: 'center'	});	}